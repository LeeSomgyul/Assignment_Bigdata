# [10ì¥] íšŒê·€ë¶„ì„
## 1. í™˜ê²½ì— ë”°ë¥¸ ì£¼íƒ ê°€ê²© ì˜ˆì¸¡í•˜ê¸°
### ğŸ–¥ï¸ì‚¬ì´í‚·ëŸ° ë‹¤ìš´ë¡œë“œ
#### âœ…In [1]
    !pip install scikit-learn


### ğŸ–¥ï¸ë°ì´í„° ìˆ˜ì§‘, ì¤€ë¹„ ë° íƒìƒ‰
#### sklearn 1.2 ë²„ì „ë¶€í„° load_boston ë¯¸ì œê³µìœ¼ë¡œ ì½”ë“œë¥¼ ë³€ê²½í•˜ì˜€ë‹¤.

#### âœ… In [2]: ìˆ˜ì •ì „
    import numpy as np
    import pandas as pd
    
    from sklearn.datasets import load_boston 
    boston = load_boston()
#### âœ… In [2]: ìˆ˜ì •í›„
    import numpy as np
    import pandas as pd
    
    from sklearn.datasets import fetch_openml
    boston = fetch_openml(name='boston')

#### âœ… In [3]
    print(boston.DESCR)
bostonì— ëŒ€í•œ ì„¤ëª…(DESCR)ì„ ì½˜ì†”ì°½ì— ë³´ì—¬ì¤€ë‹¤.
###### <img width="437" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/0c897265-edc6-4bab-9437-83e252d03a79">

#### âœ… In [4]
    boston_df = pd.DataFrame(boston.data, columns=boston.feature_names)
    boston_df.head()
1) pd.DataFrame()ì€ pandasë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë°ì´í„°ë¥¼ ë°ì´í„°í”„ë ˆì„ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•´ì¤€ë‹¤.
2) boston.dataì€ ë³´ìŠ¤í„´ ì£¼íƒ ê°€ê²© ì„¸ë¶€ ë°ì´í„°ì´ê³  boston.feature_namesì€ ë°ì´í„°ì˜ ì—´ ì´ë¦„ì´ë‹¤.
3) .head()ì€ ê¸°ë³¸ì ìœ¼ë¡œ 5ê°œ í–‰ì„ ì¶œë ¥í•œë‹¤. ì¦‰ boston_dfì— ì €ì¥ëœ ë°ì´í„° ì¤‘ 5ê°œ í–‰ì„ ì¶œë ¥í•œë‹¤.

#### â˜‘ï¸ Out [4]
<img width="800" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/292051ba-ac32-4bd6-8a5b-c8717b189651">

#### âœ… In [5]
    boston_df['PRICE'] = boston.target
    boston_df.head()
boston.targetì€ ì£¼íƒê°€ê²©ì´ í¬í•¨ëœ ë°°ì—´ë¡œ, boston_dfì— PRICEì—´ì„ ì¶”ê°€í•˜ì—¬ ì£¼íƒê°€ê²©ì„ ë‹´ëŠ”ë‹¤.

#### â˜‘ï¸ Out [5]
<img width="900" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/008b6cce-7dd6-40d1-9722-6e2b55dd1643">

#### âœ… In [6]
    print('ë³´ìŠ¤í†¤ ì£¼íƒ ê°€ê²© ë°ì´í„°ì…‹ í¬ê¸°:', boston_df.shape)
.shapeëŠ” boston_dfì˜ í–‰,ì—´ì˜ ê°œìˆ˜ë¥¼ ì•Œë ¤ì¤€ë‹¤.

#### â˜‘ï¸ Out [6]
í–‰ì˜ ê°œìˆ˜ëŠ” 506ê°œ, ì—´ì˜ ê°œìˆ˜ëŠ” 14ê°œì´ë‹¤.
14ê°œì˜ ì—´ ì¤‘ì—ì„œ 13ê°œ(CRIM ~ LSTATëŠ” ë…ë¦½ë³€ìˆ˜ Xì´ê³ , PRICEëŠ” Xì— ì˜í–¥ì„ ë°›ì•„ ê²°ì •ë˜ê¸° ë•Œë¬¸ì— ì¢…ì†ë³€ìˆ˜ Yê°€ ëœë‹¤.)
###### <img width="400" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/63e4b0cf-3aec-4dba-aa03-e4f45ee66be5">


#### âœ… In [7]
    boston_df.info()
boston_dfì˜ ì •ë³´ë¥¼ í™•ì¸í•œë‹¤.

#### â˜‘ï¸ Out [7]
ì—´ ì´ë¦„ / 506ê°œ í–‰ì—ì„œ ë¹„ì–´ ìˆì§€ ì•Šì€ ê°’ì˜ ê°œìˆ˜ / ë°ì´í„° ìœ í˜• ìˆœìœ¼ë¡œ í‘œê¸°ëœë‹¤.
###### <img width="300" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/b311b983-bec7-42a0-a444-9a1664960703">


### ğŸ–¥ï¸ì„ í˜• íšŒê·€ë¥¼ ì´ìš©í•´ ëª¨ë¸ êµ¬ì¶•í•˜ê¸°
#### âœ… In [8]
    from sklearn.linear_model import LinearRegression
    from sklearn.model_selection import train_test_split
    from sklearn.metrics import mean_squared_error, r2_score
1) LinearRegression: ë¨¸ë‹ëŸ¬ì‹  íšŒê·€ë¶„ì„ì„ ìœ„í•œ í•¨ìˆ˜(íšŒê·€ ëª¨ë¸ êµ¬í˜„ ê¸°ëŠ¥)
2) train_test_split: ë°ì´í„°ì…‹ ë¶„ë¦¬ì‘ì—…ì„ ìœ„í•œ í•¨ìˆ˜(ë°ì´í„°ë¥¼ í•™ìŠµ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë‚˜ëˆ„ëŠ” ê¸°ëŠ¥)
3) mean_squared_error: ì„±ëŠ¥ ì¸¡ì •ì„ ìœ„í•œ í•¨ìˆ˜(ì˜ˆì¸¡ê°’ê³¼ ì‹¤ì œê°’ ì‚¬ì´ì˜ ì œê³± ì˜¤ì°¨ë¥¼ í‰ê· í•˜ì—¬ ëª¨ë¸ì˜ ì˜ˆì¸¡ ì„±ëŠ¥ì„ í‰ê°€, í‰ê°€ì§€í‘œ ì¤‘ MSEë¡œ ì‹¤ì œê°’ê³¼ ì´ìƒê°’ ì‚¬ì´ì˜ ì°¨ì´ê°€ í¬ë‹¤)
4) r2_score: ëª¨ë¸ì˜ ì í•©ì„± í‰ê°€ë¥¼ ìœ„í•œ í•¨ìˆ˜

#### âœ… In [9]
    Y = boston_df['PRICE']
    X = boston_df.drop(['PRICE'], axis=1, inplace=False)
Xë¥¼ ë…ë¦½ë³€ìˆ˜, Yë¥¼ ì¢…ì†ë³€ìˆ˜ë¡œ ì„¤ì •

#### âœ… In [10]
    X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.3, random_state=156)
train_test_split()í•¨ìˆ˜ë¥¼ í†µí•´ ë°ì´í„°ì…‹ì„ í›ˆë ¨ìš© ë°ì´í„° 7, í…ŒìŠ¤íŠ¸ ë°ì´í„° 3 ë¹„ìœ¨ë¡œ ë‚˜ëˆˆë‹¤.
1) X_train: í›ˆë ¨ ì…ë ¥ ë°ì´í„°(ì£¼íƒ íŠ¹ì§•ì— ëŒ€í•œ ë°ì´í„°)
2) Y_train: í›ˆë ¨ íƒ€ê²Ÿ ë°ì´í„°(íŠ¹ì§•ìœ¼ë¡œ ì¸í•œ í•´ë‹¹ ì£¼íƒì˜ ì‹¤ì œ íŒë§¤ ê°€ê²©)
3) X_test: í…ŒìŠ¤íŠ¸ ì…ë ¥ ë°ì´í„°(ìƒˆë¡œìš´ ì£¼íƒ íŠ¹ì§•ì— ëŒ€í•œ ë°ì´í„°ë¡œ í›ˆë ¨ ë°ì´í„°ë¡œ í•™ìŠµëœ ëª¨ë¸ì—ê²Œ ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ì ìš©í•œë‹¤)
4) Y_test: í…ŒìŠ¤íŠ¸ íƒ€ê²Ÿ ë°ì´í„°(ì˜ˆì¸¡ê°’(Y_predict)ê³¼ ë¹„êµí•˜ì—¬ ëª¨ë¸ ì„±ëŠ¥ í™•ì¸)

#### âœ… In [11]
    lr = LinearRegression()
ì„ í˜• íšŒê·€ ë¶„ì„ ëª¨ë¸ë¡œ lr ìƒì„±

#### âœ… In [12]
    lr.fit(X_train, Y_train)
.fití•¨ìˆ˜ë¡œ í›ˆë ¨ìš© ë°ì´í„°ë¡œ ëª¨ë¸ í•™ìŠµ

#### â˜‘ï¸ Out [12]
<img width="200" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/a02ad707-07c1-4e13-8b82-3806a43c27d3">

#### âœ… In [13]
    Y_predict = lr.predict(X_test)
.predict()í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì£¼íƒì˜ íŠ¹ì§•(X_test)ì„ ì…ë ¥ë°›ì•„ Y_predictì— ì˜ˆì¸¡ ê°€ê²©ì„ ì €ì¥í•œë‹¤.
###### ğŸ’¡Y_testê°€ ì•„ë‹Œ X_testë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ : Y_testëŠ” ëª¨ë¸ í‰ê°€ë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ë¡œ ë‚˜ì¤‘ì— Y_predictì™€ ë¹„êµí•˜ì—¬ ì‹¤ì œê°’ê³¼ ì˜ˆì¸¡ê°’ì„ ë¹„êµí•œëŠ”ë° ì‚¬ìš©ë  ì˜ˆì •ì´ë‹¤.

#### âœ… In [14]
    mse = mean_squared_error(Y_test, Y_predict)
    rmse = np.sqrt(mse)
    
    print('MSE : {0:.3f}, RMSE : {1:.3f}'.format(mse, rmse))
    print('R^2(Variance score) : {0:.3f}'.format(r2_score(Y_test, Y_predict)))
1) mean_squared_errorí•¨ìˆ˜ëŠ” ì‹¤ì œê°’(Y_test)ê³¼ ì˜ˆì¸¡ê°’(Y_predict)ì˜ í‰ê·  ì œê³± ì˜¤ì°¨ë¥¼ ì¶œë ¥í•œë‹¤.
   (ì¶œë ¥ê°’ì´ ì‘ì„ìˆ˜ë¡ ëª¨ë¸ì˜ ì˜ˆì¸¡ì´ ì‹¤ì œ ê°’ì— ê°€ê¹ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸)
2) np.sqrtëŠ” ì œê³±ê·¼ì„ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜ë¡œ MSEì— ë£¨íŠ¸ë¥¼ ì”Œì›Œ ì´ìƒê°’ì„ ì¤„ì´ëŠ” RMSEê°’ìœ¼ë¡œ ì¶œë ¥í•œë‹¤.
3) MSEì™€ RMSEê°’ì„ ì†Œìˆ˜ì  ì…‹ì§¸ìë¦¬ê¹Œì§€ ì¶œë ¥
4) r2_score()í•¨ìˆ˜ë¡œ ëª¨ë¸ì´ ì–¼ë§ˆë‚˜ ì˜ ì˜ˆì¸¡í•˜ëŠ”ì§€ ì„±ëŠ¥ íŒŒì•…. (ì¶œë ¥ê°’ì´ 1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ëª¨ë¸ì´ ë°ì´í„°ë¥¼ ì˜ ì„¤ëª…í•œë‹¤ëŠ” ì˜ë¯¸)
###### ğŸ’¡X_testì™€ Y_testì˜ íƒ€ì…ì´ ë§ì§€ ì•Šì•„ <img width="400" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/f57c6775-a517-4321-82df-0318c7470284">ì˜¤ë¥˜ê°€ ë°œìƒí•¨ìœ¼ë¡œ In [10] ì½”ë“œ í•˜ë‹¨ì— ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•œë‹¤.
    X_test = np.array(X_test)
    Y_test = np.array(Y_test)

#### â˜‘ï¸ Out [14]
<img width="300" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/3ed78f60-5afb-4618-90ef-7bfa6e1a3b36">

#### âœ… In [15]
    print('Y ì ˆí¸ ê°’:', lr.intercept_)
    print('íšŒê·€ ê³„ìˆ˜ ê°’:', np.round(lr.coef_, 1))
1) Y ì ˆí¸: ë…ë¦½ë³€ìˆ˜ Xê°€ 0ì¼ë•Œ ì¢…ì†ë³€ìˆ˜ Yì˜ ê°’(ì£¼íƒì˜ ë°© ê°œìˆ˜, ë¹„ìœ¨(X) ë“±ì´ 0ì¼ ë•Œ ê¸°ë³¸ ê°€ê²©(Y))
2) íšŒê·€ ê³„ìˆ˜: Xê°’ì´ 1 ì¦ê°€í•  ë•Œ Yê°’ì´ ì–¼ë§ˆë‚˜ ì¦ê°€ ë˜ëŠ” ê°ì†Œí•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’

#### â˜‘ï¸ Out [15]
<img width="650" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/38f00899-a4bc-4701-a7f2-bcbfeb3ce4fb">

#### âœ… In [16]
    coef = pd.Series(data = np.round(lr.coef_, 2), index=X.columns)
    coef.sort_values(ascending=False)
1) íšŒê·€ ê³„ìˆ˜ë¥¼(lr.coef_) 2ì§¸ìë¦¬ê¹Œì§€ ë°˜ì˜¬ë¦¼(np.round)í•œë‹¤.
2) ì‹œê°í™” ë° Xì»¬ëŸ¼ìœ¼ë¡œ ì¸ë±ìŠ¤ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë„ë¡(index=X.columns) íŒë‹¤ìŠ¤ ì‹œë¦¬ì¦ˆ ë°°ì—´í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•œë‹¤.(pd.Series)
3) .sort_values(ascending=False): ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬

#### â˜‘ï¸ Out [16]
<img width="200" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/38567d4e-9de1-4a84-9198-716658afeda7">


### ğŸ–¥ï¸íšŒê·€ ë¶„ì„ ê²°ê³¼ë¥¼ ì‚°ì ë„ + ì„ í˜• íšŒê·€ ê·¸ë˜í”„ë¡œ ì‹œê°í™”í•˜ê¸°
#### âœ… In [17]
    import matplotlib.pyplot as plt
    import seaborn as sns
ì‹œê°í™”ë¥¼ í•˜ê¸° ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ importí•œë‹¤.

#### âœ… In [18]
    fig, axs = plt.subplots(figsize = (16, 16), ncols=3, nrows=5)
    
    x_features = ['CRIM', 'ZN', 'INDUS', 'CHAS', 'NOX', 'RM', 'AGE', 'DIS', 'RAD', 'TAX', 'PTRATIO', 'B', 'LSTAT']
    
    for i, feature in enumerate(x_features):
        row = int(i/3)
        col = i%3
        sns.regplot(x=feature, y='PRICE', data=boston_df, ax=axs[row][col])
1) .subplots(): 5í–‰ 3ì—´ì˜ ì‚°ì ë„ ê·¸ë˜í”„ë¥¼ ìƒì„±í•œë‹¤.(figëŠ” ì „ì²´ í‹€, axsëŠ” 5í–‰ 3ì—´ì˜ ê° ìš”ì†Œë¥¼ ì˜ë¯¸í•œë‹¤.)
2) x_features: 'PRICE'ì™€ ë¹„êµí•  13ê°œì˜ íŠ¹ì„± ë¦¬ìŠ¤íŠ¸ë¥¼ ì •ì˜í•œë‹¤.(ë…ë¦½ë³€ìˆ˜)
3) enumerate():  x_featuresë¥¼ ëŒë©´ì„œ í•˜ë‚˜ì”© ê·¸ë˜í”„ë¥¼ ì¶œë ¥í•˜ë©° rowì™€ colë¡œ ê·¸ë˜í”„ê°€ ìœ„ì¹˜ë¥¼ ê²°ì •í•´ì¤€ë‹¤.
4) sns.regplot(): ì„ í˜• íšŒê·€ì„ ì„ ê·¸ë ¤ì£¼ëŠ” í•¨ìˆ˜ë¡œ xì¶•ì„ x_featuresì—ì„œ, yì¶•ì€ 'PRICE'ë¡œ í•œë‹¤.
###### ğŸ’¡x_featuresë°ì´í„°ë“¤ì´ ë²”ì£¼í˜• ë°ì´í„°ë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.
<img width="500" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/055f6dbd-08bc-4c6e-95a3-4a362bd5080b">

###### ìœ„ì™€ ê°™ì€ ì—ëŸ¬ëŠ” x_featuresë¥¼ ìˆ˜ì¹˜í˜• ë°ì´í„°ë¡œ ë°”ê¿”ì£¼ë©´ í•´ê²°ë¨ìœ¼ë¡œ In[17] ì•„ë˜ì— ë‹¤ìŒ ì½”ë“œë¥¼ ì¶”ê°€í•´ ì¤€ë‹¤.
    for column in boston_df.columns:
        if boston_df[column].dtype.name == 'category' or boston_df[column].dtype == object:
            boston_df[column] = boston_df[column].astype('float')

#### â˜‘ï¸ Out [18]
<img width="500" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/3aa582a2-8df1-4122-9e25-c9751e2e9719">

    

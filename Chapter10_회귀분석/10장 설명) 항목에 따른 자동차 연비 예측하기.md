# [10ì¥] íšŒê·€ë¶„ì„: í•­ëª©ì— ë”°ë¥¸ ìë™ì°¨ ì—°ë¹„ ì˜ˆì¸¡í•˜ê¸°
### ğŸ–¥ï¸ë°ì´í„° ì¤€ë¹„ ë° íƒìƒ‰
#### âœ…In [1]
    import numpy as np
    import pandas as pd
    data_df = pd.read_csv('./auto-mpg.csv', header=0, engine='python')
ì¤€ë¹„í•œ csvíŒŒì¼ì„ data_df(ë°ì´í„°ì…‹)ì— ì§€ì •í•œë‹¤.

#### âœ…In [2]
    print('ë°ì´í„°ì…‹ í¬ê¸°:' , data_df.shape)
    data_df.head()
1) .shape: ë°ì´í„°ì…‹ì´ 398í–‰ 9ì—´ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤ëŠ” ê²ƒì„ í™•ì¸í•œë‹¤.
2) .head(): ë°ì´í„°ì…‹ì˜ ìƒìœ„ 5ê°œ ë°ì´í„°ë¥¼ ì¶œë ¥í•œë‹¤.

#### â˜‘ï¸Out [2]
<img width="200" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/7c959526-e23b-4dca-9bae-a003532df8ed">
<img width="700" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/e519435d-d38c-4db9-b1ed-e20a105a74a8">

#### âœ…In [3]
    data_df = data_df.drop(['car_name', 'origin', 'horsepower'], axis = 1, inplace = False)
    data_df.head()
ë°ì´í„°ì…‹ì—ì„œ ['car_name', 'origin', 'horsepower']ëŠ” í•„ìš”í•˜ì§€ ì•ŠìŒìœ¼ë¡œ .dropí•¨ìˆ˜ë¡œ ì‚­ì œí•˜ê³  ë‹¤ì‹œ ì¶œë ¥í•œë‹¤.

#### â˜‘ï¸Out [3]
<img width="500" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/4983e18e-158e-4b4c-b125-57812f08957f">

#### âœ…In [4]
    print('ë°ì´í„°ì…‹ í¬ê¸°:', data_df.shape)
In[3]ì—ì„œ 3ê°œ ì†ì„± ì‚­ì œ í›„ ë‹¤ì‹œ í–‰ ì—´ í¬ê¸°ë¥¼ í™•ì¸í•œë‹¤.

#### â˜‘ï¸Out [4]
<img width="200" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/f09f7032-3f4e-43e1-a2db-59dede46f566">

#### âœ…In [5]
    data_df.info()
ë°ì´í„°ì…‹ì´ ì–´ë–¤ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

#### â˜‘ï¸Out [5]
ì—´ ì´ë¦„ / ë¹„ì–´ìˆì§€ ì•Šì€ ì—´ì˜ ê°œìˆ˜ / ê° ì—´ì˜ ë°ì´í„° ìœ í˜• ìˆœìœ¼ë¡œ ë‚˜íƒ€ë‚¸ë‹¤.
<img width="350" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/71b4e4ea-26f8-4ed5-88e4-2d407c907cb2">


### ğŸ–¥ï¸ì„ í˜• íšŒê·€ ë¶„ì„ ëª¨ë¸ êµ¬ì¶•í•˜ê¸°
#### âœ…In [6]
    from sklearn.linear_model import LinearRegression
    from sklearn.model_selection import train_test_split
    from sklearn.metrics import mean_squared_error, r2_score
1) LinearRegression: ì„ í˜• íšŒê·€ ëª¨ë¸ ì œê³µ
2) train_test_split: ë°ì´í„°ì…‹ì„ í›ˆë ¨ìš©, í…ŒìŠ¤íŠ¸ìš© ë°ì´í„°ë¡œ ë‚˜ëˆ ì£¼ëŠ” ê¸°ëŠ¥ ì œê³µ
3) mean_squared_error(=MSE): ì˜ˆì¸¡ê°’ê³¼ ì‹¤ì œ ê°’ ì‚¬ì´ì˜ ì°¨ì´ì˜ ì œê³± í‰ê· ì„ ê³„ì‚°í•˜ëŠ” ê¸°ëŠ¥ ì œê³µ. (ê°’ì´ ì‘ì„ìˆ˜ë¡ ëª¨ë¸ì˜ ì˜ˆì¸¡ì´ ë” ì •í™•í•˜ë‹¤ëŠ” ê²ƒì„ ë³´ì—¬ì¤€ë‹¤.)

#### âœ…In [7]
    Y = data_df['mpg']
    X = data_df.drop(['mpg'], axis = 1, inplace = False)
mpg(ìë™ì°¨ ì—°ë¹„)ë¥¼ ì¢…ì†ë³€ìˆ˜ Yë¡œ, ë‚˜ë¨¸ì§€ë¥¼ ë…ë¦½ë³€ìˆ˜ Xë¡œ ì„¤ì •í•´ì¤€ë‹¤.

#### âœ…In [8]
    X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = 0.3, random_state = 0)
1) X_train(í›ˆë ¨ìš© ì…ë ¥ ë°ì´í„°), Y_train(í›ˆë ¨ìš© ì¶œë ¥ ë°ì´í„°)
2) X_test(í…ŒìŠ¤íŠ¸ ì…ë ¥ ë°ì´í„°), Y_test(í…ŒìŠ¤íŠ¸ ì¶œë ¥ ë°ì´í„°)
3) test_size = 0.3: 7(í›ˆë ¨ìš© ë°ì´í„°):3(í…ŒìŠ¤íŠ¸ ë°ì´í„°) ë¹„ìœ¨ë¡œ ë°ì´í„°ì…‹ì„ ë‚˜ëˆ ì¤€ë‹¤.

#### âœ…In [9]
    lr = LinearRegression()
ì„ í˜• íšŒê·€ ë¶„ì„ ëª¨ë¸ì„ ìƒì„±í•œë‹¤.

#### âœ…In [10]
    lr.fit(X_train, Y_train)
í›ˆë ¨ìš© ë°ì´í„°ë¡œ ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¨ë‹¤.

#### â˜‘ï¸Out [10]
<img width="200" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/da2a4055-be81-4964-a207-5543c7463651">

#### âœ…In [11]
    Y_predict = lr.predict(X_test)
í›ˆë ¨ìš© ë°ì´í„°(X_test)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¶œë ¥ë  ì˜ˆì¸¡ê°’(Y_predict)ì„ êµ¬í•œë‹¤.

#### âœ…In [12]
    mse = mean_squared_error(Y_test, Y_predict)
    rmse = np.sqrt(mse)
    print('MSE : {0:.3f}, RMSE : {1:.3f}'.format(mse, rmse))
    print('R^2(Variance score) : {0:.3f}'.format(r2_score(Y_test, Y_predict)))
1) mean_squared_error(): ì‹¤ì œê°’(Y_test)ê³¼ ì˜ˆì¸¡ê°’(Y_predict)ì˜ í‰ê·  ì œê³± ì˜¤ì°¨ë¥¼ ì¶œë ¥í•œë‹¤. (ì¶œë ¥ê°’ì´ ì‘ì„ìˆ˜ë¡ ëª¨ë¸ì˜ ì˜ˆì¸¡ì´ ì‹¤ì œ ê°’ì— ê°€ê¹ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸)
2) np.sqrt(): ì œê³±ê·¼ì„ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜ë¡œ MSEì— ë£¨íŠ¸ë¥¼ ì”Œì›Œ ì´ìƒê°’ì„ ì¤„ì´ëŠ” RMSEê°’ìœ¼ë¡œ ì¶œë ¥í•œë‹¤.
3) MSEì™€ RMSEê°’ì„ ì†Œìˆ˜ì  ì…‹ì§¸ìë¦¬ê¹Œì§€ ì¶œë ¥
4) r2_score(): ëª¨ë¸ì´ ì–¼ë§ˆë‚˜ ì˜ ì˜ˆì¸¡í•˜ëŠ”ì§€ ì„±ëŠ¥ íŒŒì•…. (ì¶œë ¥ê°’ì´ 1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ëª¨ë¸ì´ ë°ì´í„°ë¥¼ ì˜ ì„¤ëª…í•œë‹¤ëŠ” ì˜ë¯¸)

#### â˜‘ï¸Out [12]
<img width="300" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/55b1ba44-e00b-41f4-9d87-c427583f7959">

#### âœ…In [13]
    print('Y ì ˆí¸ ê°’: ', np.round(lr.intercept_, 2))
    print('íšŒê·€ ê³„ìˆ˜ ê°’: ', np.round(lr.coef_, 2))
1) Y ì ˆí¸: ë…ë¦½ë³€ìˆ˜ Xê°€ 0ì¼ë•Œ ì¢…ì†ë³€ìˆ˜ Yì˜ ê°’(ì£¼íƒì˜ ë°© ê°œìˆ˜, ë¹„ìœ¨(X) ë“±ì´ 0ì¼ ë•Œ ê¸°ë³¸ ê°€ê²©(Y))
2) íšŒê·€ ê³„ìˆ˜: Xê°’ì´ 1 ì¦ê°€í•  ë•Œ Yê°’ì´ ì–¼ë§ˆë‚˜ ì¦ê°€ ë˜ëŠ” ê°ì†Œí•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’

#### â˜‘ï¸Out [13]
<img width="350" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/9bfe3a9c-5029-4135-abc2-a7eae8236127">

#### âœ…In [14]
    coef = pd.Series(data = np.round(lr.coef_, 2), index = X.columns)
    coef.sort_values(ascending = False)
1) íšŒê·€ ê³„ìˆ˜ë¥¼(lr.coef_) 2ì§¸ìë¦¬ê¹Œì§€ ë°˜ì˜¬ë¦¼(np.round)í•œë‹¤.
2) ì‹œê°í™” ë° Xì»¬ëŸ¼ìœ¼ë¡œ ì¸ë±ìŠ¤ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë„ë¡(index=X.columns) íŒë‹¤ìŠ¤ ì‹œë¦¬ì¦ˆ ë°°ì—´í˜•ì‹(pd.Series)ìœ¼ë¡œ ë³€í™˜í•œë‹¤.
3) .sort_values(ascending=False): ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•œë‹¤.

#### â˜‘ï¸Out [14]
<img width="250" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/f9f713ac-c235-41f5-a19c-9565b0733448">


### ğŸ–¥ï¸íšŒê·€ ë¶„ì„ ê²°ê³¼ë¥¼ ì‚°ì ë„ + ì„ í˜• íšŒê·€ ê·¸ë˜í”„ë¡œ ì‹œê°í™”í•˜ê¸°
#### âœ…In [15]
    import matplotlib.pyplot as plt
    import seaborn as sns
ì‹œê°í™”ì— í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ improtí•œë‹¤.

#### âœ…In [16]
    fig, axs = plt.subplots(figsize = (16, 16), ncols = 3, nrows = 2)
    x_features = ['model_year', 'acceleration', 'displacement', 'weight', 'cylinders']
    plot_color = ['r', 'b', 'y', 'g', 'r']
    for i, feature in enumerate(x_features):
        row = int(i/3)
        col = i%3
        sns.regplot(x = feature, y = 'mpg', data = data_df, ax = axs[row][col], color = plot_color[i])
1) .subplots(): 2í–‰ 3ì—´ì˜ ì‚°ì ë„ ê·¸ë˜í”„ë¥¼ ìƒì„±í•œë‹¤.(figëŠ” ì „ì²´ í‹€, axsëŠ” 2í–‰ 3ì—´ì˜ ê° ìš”ì†Œë¥¼ ì˜ë¯¸í•œë‹¤.)
2) x_features: 'mpg'ì™€ ë¹„êµí•  5ê°œì˜ íŠ¹ì„± ë¦¬ìŠ¤íŠ¸ë¥¼ ì •ì˜í•œë‹¤.(ë…ë¦½ë³€ìˆ˜)
3) plot_color: ê° ê·¸ë˜í”„ë³„ ìƒ‰ì„ ë‹¤ë¥´ê²Œ í•˜ê¸° ìœ„í•´ ë°°ì—´ì— ì €ì¥í•œë‹¤.(ë¹¨ê°•, íŒŒë‘, ë…¸ë‘, ì´ˆë¡, ë¹¨ê°•)
4) enumerate(): x_featuresë¥¼ ëŒë©´ì„œ í•˜ë‚˜ì”© ê·¸ë˜í”„ë¥¼ ì¶œë ¥í•˜ë©° rowì™€ colë¡œ ê·¸ë˜í”„ê°€ ìœ„ì¹˜ë¥¼ ê²°ì •í•´ì¤€ë‹¤.
5) sns.regplot(): ì„ í˜• íšŒê·€ì„ ì„ ê·¸ë ¤ì£¼ëŠ” í•¨ìˆ˜ë¡œ xì¶•ì„ x_featuresì—ì„œ, yì¶•ì€ 'mpg'ë¡œ í•œë‹¤.

#### â˜‘ï¸Out [16]
<img width="400" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/3a2a19bd-000e-4c46-8f1c-f1f3cd310543">

#### âœ…In [17]
    print("ì—°ë¹„ë¥¼ ì˜ˆì¸¡í•˜ê³  ì‹¶ì€ ì°¨ì˜ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
    
    cylinders_1 = int(input("cylinders : "))
    displacement_1 = int(input("displacement : "))
    weight_1 = int(input("weight : "))
    acceleration_1 = int(input("acceleration : "))
    model_year_1 = int(input("model_year : "))
ì™„ì„±ëœ ì—°ë¹„ ì˜ˆì¸¡ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì„ì˜ì˜ ë°ì´í„°ë¥¼ ì…ë ¥í•˜ë©´ ì—°ë¹„ë¥¼ ì˜ˆì¸¡í•  ìˆ˜ ìˆë‹¤.

#### â˜‘ï¸Out [17]
ì½˜ì†” ì°½ì—ì„œ Enterí‚¤ë¥¼ ëˆ„ë¥´ë©´ì„œ ì‚¬ìš©ìê°€ ì§ì ‘ ê°’ì„ ì…ë ¥í•  ìˆ˜ ìˆë‹¤.
<img width="350" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/6f235b0f-acc6-4d07-99dd-77d809608bdb">

#### âœ…In [18]
    mpg_predict = lr.predict([[cylinders_1, displacement_1, weight_1, acceleration_1, model_year_1]])
predictí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’ì— ëŒ€í•œ ì˜ˆì¸¡ ê²°ê³¼ê°’ì„ êµ¬í•œë‹¤.
###### ğŸ’¡[]ê°€ 2ê°œì¸ ì´ìœ : predictí•¨ìˆ˜ëŠ” ë‹¤ì°¨ì› ë°°ì—´ í˜•íƒœì˜ ì…ë ¥ê°’ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì—, ì˜ˆì¸¡í•  ë°ì´í„° í¬ì¸íŠ¸ê°€ í•˜ë‚˜ì—¬ë„ 2ì°¨ì› ë°°ì—´ë¡œ ì…ë ¥í•´ì•¼ í•œë‹¤.

#### âœ…In [19]
    print("ì´ ìë™ì°¨ì˜ ì˜ˆìƒ ì—°ë¹„(MPG)ëŠ” %.2fì…ë‹ˆë‹¤." %mpg_predict)
ì‚¬ìš©ìì˜ ì…ë ¥ê°’ì— ëŒ€í•œ ì¶œë ¥ê°’ì„ ì œê³µí•œë‹¤.

#### â˜‘ï¸Out [19]
<img width="350" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/022e40a8-fcf1-4ac6-a6b5-2e50ae79dab7">






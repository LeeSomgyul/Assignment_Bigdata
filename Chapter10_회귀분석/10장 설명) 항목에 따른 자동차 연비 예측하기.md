# [10장] 회귀분석: 항목에 따른 자동차 연비 예측하기
### 🖥️데이터 준비 및 탐색
#### ✅In [1]
    import numpy as np
    import pandas as pd
    data_df = pd.read_csv('./auto-mpg.csv', header=0, engine='python')
준비한 csv파일을 data_df(데이터셋)에 지정한다.

#### ✅In [2]
    print('데이터셋 크기:' , data_df.shape)
    data_df.head()
1) .shape: 데이터셋이 398행 9열로 이루어져 있다는 것을 확인한다.
2) .head(): 데이터셋의 상위 5개 데이터를 출력한다.

#### ☑️ Out [2]
<img width="200" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/7c959526-e23b-4dca-9bae-a003532df8ed">
<img width="700" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/e519435d-d38c-4db9-b1ed-e20a105a74a8">

#### ✅In [3]
    data_df = data_df.drop(['car_name', 'origin', 'horsepower'], axis = 1, inplace = False)
    data_df.head()
데이터셋에서 ['car_name', 'origin', 'horsepower']는 필요하지 않음으로 .drop함수로 삭제하고 다시 출력한다.

#### ☑️ Out [3]
<img width="500" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/4983e18e-158e-4b4c-b125-57812f08957f">

#### ✅In [4]
    print('데이터셋 크기:', data_df.shape)
In[3]에서 3개 속성 삭제 후 다시 행 열 크기를 확인한다.

#### ☑️ Out [4]
<img width="200" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/f09f7032-3f4e-43e1-a2db-59dede46f566">

#### ✅In [5]
    data_df.info()
데이터셋이 어떤 정보를 가지고 있는지 확인합니다.

#### ☑️ Out [5]
열 이름 / 비어있지 않은 열의 개수 / 각 열의 데이터 유형 순으로 나타낸다.
<img width="350" alt="image" src="https://github.com/LeeSomgyul/Assignment_Bigdata/assets/140570847/71b4e4ea-26f8-4ed5-88e4-2d407c907cb2">


### 🖥️선형 회귀 분석 모델 구축하기
#### ✅In [6]
    from sklearn.linear_model import LinearRegression
    from skimage.model_selection import train_test_split
    from sklearn.metrics import mean_squared_error, r2_score
1) LinearRegression: 선형 회귀 모델 제공
2) train_test_split: 데이터셋을 훈련용, 테스트용 데이터로 나눠주는 기능 제공
3) mean_squared_error(=MSE): 예측값과 실제 값 사이의 차이의 제곱 평균을 계산하는 기능 제공. (값이 작을수록 모델의 예측이 더 정확하다는 것을 보여준다.)

#### ✅In [7]
    Y = data_df['mpg']
    X = data_df.drop(['mpg'], axis = 1, inplace = False)
mpg(자동차 연비)를 종속변수 Y로, 나머지를 독립변수 X로 설정해준다.

#### ✅In [8]
    X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = 0.3, random_state = 0)
1) X_train(훈련용 입력 데이터), Y_train(훈련용 출력 데이터)
2) X_test(테스트 입력 데이터), Y_test(테스트 출력 데이터)
3) test_size = 0.3: 7(훈련용 데이터):3(테스트 데이터) 비율로 데이터셋을 나눠준다.

#### ✅In [9]
    lr = LinearRegression()
선형 회귀 분석 모델을 생성한다.

#### ✅In [10]
    lr.fit(X_train, Y_train)
훈련용 데이터로 모델을 훈련시킨다.

